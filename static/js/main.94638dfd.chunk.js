(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{46:function(e,t,n){e.exports=n(63)},51:function(e,t,n){},54:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),s=n(42),i=n.n(s),c=(n(51),n(54),n(6)),o=n(14),u=function(e){return{type:"POST_PERSON",person:e}},p=function(e){return{type:"PATCH_PERSON",person:e}},l=function(e){return{type:"DELETE_PERSON",person:e}},d=function(e){return{type:"UPDATE_PERSON",person:e}},E=function(e){return{type:"SET_SYNC_STATUS",isSyncing:e}},f=n(4),b=n.n(f),m=Object(o.b)(function(e,t){return{isLast:e.persons.length-1===b.a.findIndex(e.persons,function(e){var n=e.uid;return t.person.uid===n})}},function(e,t){return{updatePersonName:function(n){return e({type:"ON_UPDATE_PERSON",person:Object(c.a)({},t.person,{name:n})})},createOrUpdate:function(t){return e(u(t))},addPerson:function(){return e({type:"ADD_PERSON"})},removePerson:function(){return e({type:"REMOVE_PERSON",person:t.person})}}})(function(e){var t=e.person,n=e.updatePersonName,r=(e.createOrUpdate,e.addPerson),s=e.isLast,i=e.removePerson;return a.a.createElement("div",{className:"card person-card"},a.a.createElement("form",{className:"card-content",onSubmit:function(e){return function(e,t,n){e.preventDefault(),n&&t()}(e,r,s)}},a.a.createElement("div",{className:"field has-addons"},a.a.createElement("p",{className:"control"},a.a.createElement("span",{type:"button",style:{width:"2.7rem"},className:"button is-static",tabIndex:-1},t.id)),a.a.createElement("p",{className:"control is-expanded"},a.a.createElement("input",{type:"text",className:"input",placeholder:"Name",value:t.name,onChange:function(e){n(e.target.value)},autoFocus:!0})),a.a.createElement("p",{className:"control"},a.a.createElement("button",{type:"button",onClick:function(){return i()},style:{width:"2.7rem"},className:"button is-danger",tabIndex:-1},a.a.createElement("span",{className:"icon"},"\u2715"))))))}),O=Object(o.b)(function(e){return{persons:e.persons}})(function(e){var t=e.persons;return a.a.createElement("ul",null,t.map(function(e){return a.a.createElement("li",{key:e.uid},a.a.createElement(m,{person:e}))}))}),S=Object(o.b)(function(e){return{isSyncing:e.isSyncing}},function(e){return{addPerson:function(){return e({type:"ADD_PERSON"})},fetch:function(){return e({type:"FETCH_PERSONS"})}}})(function(e){var t=e.addPerson,n=e.fetch,r=e.isSyncing;return a.a.createElement("div",{className:"field is-grouped"},a.a.createElement("p",{className:"control is-expanded"},a.a.createElement("button",{className:"button is-fullwidth is-outlined is-success",onClick:function(){return t()}},"Add Person")),a.a.createElement("p",{className:"control is-expanded",style:{width:"15%"}},a.a.createElement("button",{className:"button is-fullwidth is-info is-outlined ".concat(""," "),disabled:r,onClick:function(){return!r&&n()}},r?"Syncing...":"Refresh")))}),h=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("section",{className:"hero is-primary is-bold"},a.a.createElement("div",{className:"hero-body"},a.a.createElement("div",{className:"container has-text-centered"},a.a.createElement("h1",{className:"title"},"Javascript\u200b \u200bUI\u200b \u200b\u2194\u200b \u200bServer\u200b \u200bsyncing"),a.a.createElement("h2",{className:"subtitle"},"Jan Calanog")))),a.a.createElement("div",{className:"section"},a.a.createElement("div",{className:"content"},a.a.createElement("p",{className:"has-text-centered is-size-7"},"Have a look at the console, there you can find mocked network request logs.")),a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"columns is-centered"},a.a.createElement("div",{className:"column is-4"},a.a.createElement(O,null),a.a.createElement(S,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var v=n(11),N=n(34),_={isSyncing:!1,persons:[]},P=n(71),j=n(65),C=function(e){var t=new P.a;return t.asObservable().pipe(Object(j.a)(1e3)).subscribe(function(t){e.dispatch(E(t))}),function(n){return function(r){switch(r.type){case"FETCH_PERSONS":case"POST_PERSON":case"PATCH_PERSON":case"DELETE_PERSON":e.dispatch(E(!0)),t.next(!0);break;case"FETCH_PERSONS_SUCCESS":case"POST_PERSON_SUCCESS":case"PATCH_PERSON_SUCCESS":case"DELETE_PERSON_SUCCESS":t.next(!1)}return n(r)}}},T=n(17),y=n(64),R=n(61),g=n(2),w=n(73),U=n(72),A=n(62),D=n(45),k=n(70),x=n(66),H=n(67),I=n(68),F=n(69),$=function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"payload.id";Object(T.a)(this,e),this.buffer$=new P.a,this.actionSubject$=new P.a,this.asObservable=function(){return Object(k.a)(n.initialObservable$,n.followUpObservable).pipe(Object(x.a)(function(e){return!!e}))},this._initFollowUpObservable=function(e){return n.actionSubject$.asObservable().pipe(Object(H.a)(n.buffer$),Object(A.a)(function(e){return b.a.last(e)}),Object(I.a)(n.buffer$),Object(A.a)(function(t){var n=Object(D.a)(t,2),r=n[0],a=n[1];return!!r&&b.a.setWith(b.a.clone(r),e,a)}),Object(w.a)(1))},this._initObservable=function(e,t){return e.pipe(Object(F.a)(function(e){n.buffer$.next(b.a.get(e,t))}),Object(w.a)(1))},this.push=function(e){n.actionSubject$.next(e)},this.followUpObservable=this._initFollowUpObservable(r),this.initialObservable$=this._initObservable(t,r)},q=function e(){var t=this;Object(T.a)(this,e),this._uidMap={},this.create=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"payload.id";return t._uidMap[e]=new $(n.pipe(Object(F.a)(function(){t._remove(e)})),r),t.get(e)},this.pushAction=function(e,n){if(!t.hasUUID(e))throw Error("Cannot find ActionPostponeObject with the UUID: ".concat(e));t.get(e).push(n)},this.hasUUID=function(e){return e in t._uidMap},this.get=function(e){return t._uidMap[e]},this._remove=function(e){delete t._uidMap[e]}},L=function(e){return function(t){var n=new q;return function(r){return function(a){var s=r(a);switch(a.type){case"ADD_PERSON":var i=b.a.last(t.getState().persons);t.dispatch(u(i));break;case"POST_PERSON":var o=a.person;n.create(o.uid,e.post(o).pipe(Object(A.a)(function(e){return{type:"POST_PERSON_SUCCESS",person:Object(c.a)({},e,{uid:o.uid})}})),"person.id").asObservable().subscribe(function(e){t.dispatch(e)});break;case"POST_PERSON_SUCCESS":var E=a.person;t.dispatch(d({uid:E.uid,id:E.id}));break;case"PATCH_PERSON":var f=a.person;-1===f.id?n.pushAction(f.uid,p(f)):e.patch(f).subscribe(function(e){t.dispatch({type:"PATCH_PERSON_SUCCESS",person:e})});break;case"REMOVE_PERSON":var m=a.person;t.dispatch(l(m));break;case"DELETE_PERSON":var O=a.person;-1===O.id?n.pushAction(O.uid,l(O)):e.delete(O).subscribe(function(e){t.dispatch({type:"DELETE_PERSON_SUCCESS",person:e})});break;case"ON_UPDATE_PERSON":var S=a.person;t.dispatch(d(S)),t.dispatch(p(S));break;case"FETCH_PERSONS":e.fetchAll().subscribe(function(e){t.dispatch(function(e){return{type:"FETCH_PERSONS_SUCCESS",persons:e}}(e))})}return s}}}},M=new function e(t){var n=this;Object(T.a)(this,e),this.fetchAll=function(){return n.http.get("/api/persons")},this.post=function(e){return n.http.post("/api/persons",e)},this.patch=function(e){return n.http.patch("/api/persons",e)},this.delete=function(e){return n.http.delete("/api/persons",e)},this.http=t}(new function e(){var t=this;Object(T.a)(this,e),this.currentId=0,this.persons=[],this.get=function(e){var n=t.persons.map(function(e){return b.a.omit(e,"uid")});return console.info("%c[GET]\t","color:green;","request:",{},"response:",n),Object(y.a)(n).pipe(Object(w.a)(1),Object(U.a)(500))},this.delete=function(e,n){return-1===n.id?Object(R.a)("ID cannot be -1"):(t.persons=t.persons.filter(function(e){return e.id!==n.id}),console.info("%c[DELETE]\t","color:green;","request:",b.a.omit(n,["uid"]),"response:",b.a.omit(n,["uid"])),Object(y.a)(n).pipe(Object(U.a)(1e3)))},this.post=function(e,n){return g.a.create(function(e){setTimeout(function(){var r=t.currentId++,a=Object(c.a)({},n,{id:r});t.persons=Object(N.a)(t.persons).concat([a]),console.info("%c[POST]\t","color:green;","request:",b.a.omit(n,["uid"]),"response:",b.a.omit(a,["uid"])),e.next(b.a.omit(a,["uid"])),e.complete()},2e3)})},this.patch=function(e,n){return g.a.create(function(e){-1===n.id&&(console.error("%c[PATCH]\t","color:red;","request:",n,"response:",{status:400,msg:"BAD REQUEST"}),e.error("ID cannot be -1")),setTimeout(function(){t.persons=t.persons.map(function(e){return e.id===n.id?Object(c.a)({},e,n):e}),console.info("%c[PATCH]\t","color:green;","request:",b.a.omit(n,["uid"]),"response:",b.a.omit(n,["uid"])),e.next(b.a.omit(n,["uid"])),e.complete()},1e3)})}}),J=Object(v.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_PERSONS_SUCCESS":return Object(c.a)({},e,{persons:t.persons.map(function(e){return Object(c.a)({},e,{uid:b.a.uniqueId("person_")})})});case"POST_PERSON_SUCCESS":var n=t.person;return Object(c.a)({},e,{persons:e.persons.map(function(e){return n.uid===e.uid?Object(c.a)({},e,{id:n.id}):e})});case"REMOVE_PERSON":var r=t.person.uid;return Object(c.a)({},e,{persons:e.persons.filter(function(e){return e.uid!==r})});case"ADD_PERSON":return Object(c.a)({},e,{persons:Object(N.a)(e.persons).concat([{id:-1,name:"",uid:b.a.uniqueId("person_")}])});case"UPDATE_PERSON":var a=t.person;return Object(c.a)({},e,{persons:e.persons.map(function(e){return a.uid===e.uid?Object(c.a)({},e,a):e})});case"SET_SYNC_STATUS":return Object(c.a)({},e,{isSyncing:t.isSyncing});default:return e}},Object(v.a)(L(M),C));i.a.render(a.a.createElement(o.a,{store:J},a.a.createElement(h,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[46,2,1]]]);
//# sourceMappingURL=main.94638dfd.chunk.js.map